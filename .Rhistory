unnest(coefs) %>%
filter(term == "year") %>%
mutate(term = fct_reorder(term, estimate)) %>%
ggplot(aes(estimate, term)) +
geom_point() +
geom_errorbarh(aes(xmin = -std.error, xmax = std.error), height = .1) +
geom_vline(xintercept = 0, color = "red", lty = 2)
lm_mod <- crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
nest(mod_data = c(year, yield_hectare, population)) %>%
mutate(model = map(mod_data, ~lm(yield_hectare ~ population + year + crop, data = .x)))
lm_mod <- crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
nest(mod_data = c(year, yield_hectare, population)) %>%
mutate(model = map(mod_data, ~lm(yield_hectare ~ population + year, data = .x)))
crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
nest(mod_data = c(year, yield_hectare, population)) %>%
mutate(model = map(mod_data, ~lm(yield_hectare ~ population + year, data = .x))) %>%
mutate(coefs = map(model, tidy)) %>%
unnest(coefs)
# Randomly select 9 country names
# set.seed(1014) if you want to select the same 9 countries each time
crops <- crop_yield_tidy %>% distinct(crop) %>%  pull()
country_random <- crop_yield_tidy %>%
# filter(crop %in% crops) %>%
select(country) %>%
distinct() %>%
slice_sample(n = 9) %>%
pull()
crop_yield_tidy %>%
filter(country == 'United States') %>%
ggplot(aes(year, yield_hectare, color = crop)) +
geom_line() +
facet_wrap(~country, 'free_x') +
labs(
title = 'Crop Yield USA',
y = 'Year',
x = 'tonnes per hectare per year'
)
# plot of USA data only
crop_yield_tidy %>%
filter(country == 'United States') %>%
mutate(crop = fct_reorder(crop, yield_hectare)) %>%
ggplot(aes(yield_hectare, crop, fill = crop)) +
geom_col()  +
facet_wrap(~country, scales = 'free_y') +
theme(legend.position =  'none') +
labs(
title = 'Crop Yield USA',
y = 'Crop',
x = 'tonnes per hectare'
)
# Plot crop yield per hectare per year.
crop_yield_tidy %>%
filter(
country %in% country_random,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
mutate(crop = fct_reorder(crop, yield_hectare)) %>%
ggplot(aes(year, yield_hectare, color = crop)) +
geom_line(size = 1, alpha = 0.5) +
facet_wrap(~country, scales = 'free_y') +
labs(
y = 'yield per hectare',
title = 'Crop Yield'
)
lm_mod <- crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
nest(mod_data = c(year, yield_hectare, population)) %>%
mutate(model = map(mod_data, ~lm(yield_hectare ~ population + year + country, data = .x)))
m_mod <- crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
mutate(country = fct_relevel(country, population))
crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
mutate(country = fct_relevel(country, population))
crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
nest(mod_data = c(year, yield_hectare, population)) %>%
mutate(model = map(mod_data, ~lm(yield_hectare ~ population + year, data = .)))
crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
nest(mod_data = c(year, yield_hectare, population)) %>%
mutate(model = map(mod_data, ~lm(yield_hectare ~ population + year, data = .))) %>%
mutate(coefs = map(model, tidy)) %>%
unnest(coefs)
crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
nest(mod_data = c(year, yield_hectare, population)) %>%
mutate(model = map(mod_data, ~lm(yield_hectare ~ population + country, data = .)))
crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
nest(mod_data = c(year, yield_hectare, population)) %>%
mutate(model = map(mod_data, ~lm(yield_hectare ~ population + year, data = .))) %>%
mutate(coefs = map(model, tidy)) %>%
unnest(coefs)
lm_mod <- crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
nest(mod_data = c(year, yield_hectare, population)) %>%
mutate(model = map(mod_data, ~lm(yield_hectare ~ population + year, data = .))) %>%
mutate(coefs = map(model, tidy)) %>%
unnest(coefs) %>%
filter(term == "year") %>%
mutate(p.value = p.adjust(p.value)) %>%
ggplot(aes(estimate, p.value, label = entity)) +
geom_vline(xintercept = 0, lty = 2,
size = 1.5, alpha = 0.7, color = "gray50") +
geom_point(aes(color = crop), alpha = 0.8, size = 2.5, show.legend = FALSE) +
scale_y_log10() +
facet_wrap(~crop) +
geom_text_repel(size = 3, family = "")
library(ggrepel)
lm_mod <- crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
nest(mod_data = c(year, yield_hectare, population)) %>%
mutate(model = map(mod_data, ~lm(yield_hectare ~ population + year, data = .))) %>%
mutate(coefs = map(model, tidy)) %>%
unnest(coefs) %>%
filter(term == "year") %>%
mutate(p.value = p.adjust(p.value)) %>%
ggplot(aes(estimate, p.value, label = entity)) +
geom_vline(xintercept = 0, lty = 2,
size = 1.5, alpha = 0.7, color = "gray50") +
geom_point(aes(color = crop), alpha = 0.8, size = 2.5, show.legend = FALSE) +
scale_y_log10() +
facet_wrap(~crop) +
geom_text_repel(size = 3, family = "")
lm_mod
crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
nest(mod_data = c(year, yield_hectare, population)) %>%
mutate(model = map(mod_data, ~lm(yield_hectare ~ population + year, data = .))) %>%
mutate(coefs = map(model, tidy)) %>%
unnest(coefs) %>%
filter(term == "year") %>%
mutate(p.value = p.adjust(p.value)) %>%
ggplot(aes(estimate, p.value, label = entity)) +
geom_vline(xintercept = 0, lty = 2,
size = 1.5, alpha = 0.7, color = "gray50") +
geom_point(aes(color = crop), alpha = 0.8, size = 2.5, show.legend = FALSE) +
scale_y_log10() +
facet_wrap(~crop) +
geom_text_repel(size = 3, family = "")
crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
nest(mod_data = c(year, yield_hectare, population)) %>%
mutate(model = map(mod_data, ~lm(yield_hectare ~ population + year, data = .))) %>%
mutate(coefs = map(model, tidy)) %>%
unnest(coefs) %>%
filter(term == "year") %>%
mutate(p.value = p.adjust(p.value)) %>%
ggplot(aes(estimate, p.value, label = country)) +
geom_vline(xintercept = 0, lty = 2,
size = 1.5, alpha = 0.7, color = "gray50") +
geom_point(aes(color = crop), alpha = 0.8, size = 2.5, show.legend = FALSE) +
scale_y_log10() +
facet_wrap(~crop) +
geom_text_repel(size = 3, family = "")
crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
nest(mod_data = c(year, yield_hectare, population)) %>%
mutate(model = map(mod_data, ~lm(yield_hectare ~ population + year, data = .))) %>%
mutate(coefs = map(model, tidy)) %>%
unnest(coefs) %>%
filter(term == "year") %>%
mutate(p.value = p.adjust(p.value)) %>%
ggplot(aes(estimate, p.value, label = country)) +
geom_vline(xintercept = 0, lty = 2,
size = 1.5, alpha = 0.7, color = "gray50") +
geom_point(aes(color = crop), alpha = 0.8, size = 2.5, show.legend = FALSE) +
scale_y_log10() +
facet_wrap(~crop) +
geom_text_repel(size = 3, family = "")
crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
nest(mod_data = c(year, yield_hectare, population)) %>%
mutate(model = map(mod_data, ~lm(yield_hectare ~ population + year, data = .))) %>%
mutate(coefs = map(model, tidy)) %>%
unnest(coefs) %>%
filter(term == "year") %>%
mutate(p.value = p.adjust(p.value)) %>%
ggplot(aes(estimate, p.value, label = country)) +
geom_vline(xintercept = 0, lty = 2,
size = 1.5, alpha = 0.7, color = "gray50") +
geom_point(aes(color = crop), alpha = 0.8, size = 2.5, show.legend = FALSE) +
scale_y_log10() +
facet_wrap(~crop) +
geom_text_repel(size = 3, family = "")
crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
nest(mod_data = c(year, yield_hectare, population)) %>%
mutate(model = map(mod_data, ~lm(yield_hectare ~ population + year, data = .))) %>%
mutate(coefs = map(model, tidy)) %>%
unnest(coefs) %>%
filter(term == "year") %>%
mutate(p.value = p.adjust(p.value)) %>%
ggplot(aes(estimate, p.value, label = country)) +
geom_vline(xintercept = 0, lty = 2,
size = 1.5, alpha = 0.7, color = "gray50") +
geom_point(aes(color = crop), alpha = 0.8, size = 2.5, show.legend = FALSE) +
scale_y_log10() +
facet_wrap(~crop) +
geom_text_repel(size = 3, family = "") +
theme(theme_minimal())
crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
nest(mod_data = c(year, yield_hectare, population)) %>%
mutate(model = map(mod_data, ~lm(yield_hectare ~ population + year, data = .))) %>%
mutate(coefs = map(model, tidy)) %>%
unnest(coefs) %>%
filter(term == "year") %>%
mutate(p.value = p.adjust(p.value)) %>%
ggplot(aes(estimate, p.value, label = country)) +
geom_vline(xintercept = 0, lty = 2,
size = 1.5, alpha = 0.7, color = "gray50") +
geom_point(aes(color = crop), alpha = 0.8, size = 2.5, show.legend = FALSE) +
scale_y_log10() +
facet_wrap(~crop) +
geom_text_repel(size = 3, family = "") +
theme_set(theme_minimal())
crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
nest(mod_data = c(year, yield_hectare, population)) %>%
mutate(model = map(mod_data, ~lm(yield_hectare ~ population + year, data = .))) %>%
mutate(coefs = map(model, tidy)) %>%
unnest(coefs) %>%
filter(term == "year") %>%
mutate(p.value = p.adjust(p.value)) %>%
ggplot(aes(estimate, p.value, label = country)) +
geom_vline(xintercept = 0, lty = 2,
size = 1.5, alpha = 0.7, color = "gray50") +
geom_point(aes(color = crop), alpha = 0.8, size = 2.5, show.legend = FALSE) +
scale_y_log10() +
facet_wrap(~crop) +
geom_text_repel(size = 3, family = "Garamond") +
theme_set(theme_minimal())
blogdown::stop_server()
blogdown::serve_site()
crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
nest(mod_data = c(year, yield_hectare, population)) %>%
mutate(model = map(mod_data, ~lm(yield_hectare ~ population + year, data = .))) %>%
mutate(coefs = map(model, tidy)) %>%
unnest(coefs) %>%
filter(term == "year") %>%
mutate(p.value = p.adjust(p.value)) %>%
ggplot(aes(estimate, p.value, label = country)) +
geom_vline(xintercept = 0, lty = 2,
size = 1.5, alpha = 0.7, color = "gray50") +
geom_point(aes(color = crop), alpha = 0.8, size = 2.5, show.legend = FALSE) +
scale_y_log10() +
facet_wrap(~crop) +
geom_text_repel(size = 3, family = "Courier") +
theme_set(theme_minimal())
crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
nest(mod_data = c(year, yield_hectare, population)) %>%
mutate(model = map(mod_data, ~lm(yield_hectare ~ population + year, data = .))) %>%
mutate(coefs = map(model, tidy)) %>%
unnest(coefs) %>%
filter(term == "year") %>%
mutate(p.value = p.adjust(p.value)) %>%
ggplot(aes(estimate, p.value, label = country)) +
geom_vline(xintercept = 0, lty = 2,
size = 1.5, alpha = 0.7, color = "gray50") +
geom_point(aes(color = crop), alpha = 0.8, size = 2.5, show.legend = FALSE) +
scale_y_log10() +
facet_wrap(~crop) +
geom_text_repel(size = 3, family = "Times New Roman") +
theme_set(theme_minimal())
crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
nest(mod_data = c(year, yield_hectare, population)) %>%
mutate(model = map(mod_data, ~lm(yield_hectare ~ population + year, data = .))) %>%
mutate(coefs = map(model, tidy)) %>%
unnest(coefs) %>%
filter(term == "year") %>%
mutate(p.value = p.adjust(p.value)) %>%
ggplot(aes(estimate, p.value, label = country)) +
geom_vline(xintercept = 0, lty = 2,
size = 1.5, alpha = 0.7, color = "gray50") +
geom_point(aes(color = crop), alpha = 0.8, size = 2.5, show.legend = FALSE) +
scale_y_log10() +
facet_wrap(~crop) +
geom_text_repel(size = 3, family = "Times New Roman")
crop_yield_tidy %>%
drop_na() %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
nest(mod_data = c(year, yield_hectare, population)) %>%
mutate(model = map(mod_data, ~lm(yield_hectare ~ population + year, data = .))) %>%
mutate(coefs = map(model, tidy)) %>%
unnest(coefs) %>%
filter(term == "year") %>%
mutate(p.value = p.adjust(p.value)) %>%
ggplot(aes(estimate, p.value, label = country)) +
geom_vline(xintercept = 0, lty = 2,
size = 1.5, alpha = 0.7, color = "gray50") +
geom_point(aes(color = crop), alpha = 0.8, size = 2.5, show.legend = FALSE) +
scale_y_log10() +
facet_wrap(~crop) +
geom_text_repel(size = 2.5, family = "Times New Roman")
crop_yield_tidy %>%
filter(country == 'United States') %>%
ggplot(aes(year, yield_hectare, color = crop)) +
geom_line() +
facet_wrap(~country, 'free_x') +
theme(plot.title.position = 'plot') +
labs(
title = 'Crop Yield USA',
y = 'Year',
x = 'tonnes per hectare per year'
)
crop_yield_tidy %>%
filter(country == 'United States') %>%
ggplot(aes(year, yield_hectare, color = crop)) +
geom_line() +
facet_wrap(~country, 'free_x') +
theme(plot.title.position = 'plot') +
labs(
title = 'Crop Yield USA',
y = 'Year',
x = 'tonnes per hectare per year'
)
# plot of USA data only
crop_yield_tidy %>%
filter(country == 'United States') %>%
mutate(crop = fct_reorder(crop, yield_hectare)) %>%
ggplot(aes(yield_hectare, crop, fill = crop)) +
geom_col()  +
facet_wrap(~country, scales = 'free_y') +
theme(legend.position =  'none',
plot.title.position = 'plot') +
labs(
title = 'Crop Yield USA',
y = 'Crop',
x = 'tonnes per hectare'
)
crop_yield_tidy %>%
filter(country %in% top_pops,
crop == c('maize', 'potatoes', 'wheat', 'bananas')) %>%
mutate(crop = reorder_within(crop, yield_hectare, country)) %>%
ggplot(aes(yield_hectare, crop, fill = crop)) +
geom_col()  +
scale_y_reordered() +
facet_wrap(~country, scales = 'free') +
theme(legend.position = 'none',
plot.label.position = 'plot') +
labs(
title = 'Crop Yield',
y = 'Crop',
x = 'yield per hectare'
)
crop_yield_tidy %>%
filter(country %in% top_pops,
crop == c('maize', 'potatoes', 'wheat', 'bananas')) %>%
mutate(crop = reorder_within(crop, yield_hectare, country)) %>%
ggplot(aes(yield_hectare, crop, fill = crop)) +
geom_col()  +
scale_y_reordered() +
facet_wrap(~country, scales = 'free') +
theme(legend.position = 'none',
plot.label.position = 'plot') +
labs(
title = 'Crop Yield',
y = 'Crop',
x = 'yield per hectare'
)
crop_yield_tidy %>%
filter(country %in% top_pops,
crop == c('maize', 'potatoes', 'wheat', 'bananas')) %>%
mutate(crop = reorder_within(crop, yield_hectare, country)) %>%
ggplot(aes(yield_hectare, crop, fill = crop)) +
geom_col()  +
scale_y_reordered() +
facet_wrap(~country, scales = 'free') +
theme(legend.position = 'none') +
theme(plot.label.position = 'plot') +
labs(
title = 'Crop Yield',
y = 'Crop',
x = 'yield per hectare'
)
country %in% country_random,
country %in% country_random,
country_random <- crop_yield_tidy %>%
# filter(crop %in% crops) %>%
select(country) %>%
distinct() %>%
slice_sample(n = 9) %>%
pull()
country_random <- crop_yield_tidy %>%
select(country) %>%
distinct() %>%
slice_sample(n = 9) %>%
pull()
crop_yield_tidy %>%
filter(country == 'United States') %>%
ggplot(aes(year, yield_hectare, color = crop)) +
geom_line() +
facet_wrap(~country, 'free_x') +
theme(plot.title.position = 'plot') +
labs(
title = 'Crop Yield USA',
y = 'Year',
x = 'tonnes per hectare per year'
)
# plot of USA data only
crop_yield_tidy %>%
filter(country == 'United States') %>%
mutate(crop = fct_reorder(crop, yield_hectare)) %>%
ggplot(aes(yield_hectare, crop, fill = crop)) +
geom_col()  +
facet_wrap(~country, scales = 'free_y') +
theme(legend.position =  'none',
plot.title.position = 'plot') +
labs(
title = 'Crop Yield USA',
y = 'Crop',
x = 'tonnes per hectare'
)
country %in% country_random,
# Plot crop yield per hectare per year.
crop_yield_tidy %>%
filter(country %in% country_random,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
mutate(crop = fct_reorder(crop, yield_hectare)) %>%
ggplot(aes(year, yield_hectare, color = crop)) +
geom_line(size = 1, alpha = 0.5) +
facet_wrap(~country, scales = 'free_y') +
theme(plot.title.position = 'plot') +
labs(
y = 'yield per hectare',
title = 'Crop Yield'
)
crop_yield_tidy %>%
filter(country %in% top_pops,
crop == c('maize', 'potatoes', 'wheat', 'bananas')) %>%
mutate(crop = reorder_within(crop, yield_hectare, country)) %>%
ggplot(aes(yield_hectare, crop, fill = crop)) +
geom_col()  +
scale_y_reordered() +
facet_wrap(~country, scales = 'free') +
theme(legend.position = 'none',
plot.title.position = 'plot') +
labs(
title = 'Crop Yield',
y = 'Crop',
x = 'yield per hectare'
)
country %in% top_pops,
crop_yield_tidy %>%
filter(country %in% top_pops,
crop %in% c('maize', 'potatoes', 'wheat', 'bananas')) %>%
mutate(crop = fct_reorder(crop, yield_hectare)) %>%
ggplot(aes(year, yield_hectare, color = crop)) +
geom_line(size = 1, alpha = 0.5) +
theme(plot.title.position = 'plot') +
facet_wrap(~country, scales = 'free_y') +
labs(
y = 'yield per hectare',
title = 'Crop Yield'
)
title = ":heart: <i class='fab fa-r-project'  style='color: #FFBF00'></i> Blog"
subtitle = "<span style='color:#FFBF00'> orange :heart:</span>"
blogdown:::insert_image_addin()
884000/74000
74000/884000
